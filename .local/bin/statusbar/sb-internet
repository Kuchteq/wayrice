#!/bin/sh

# Show wifi ðŸ“¶ and percent strength or ðŸ“¡ if none.
# Show ó°ˆ€ if connected to ethernet or âŽ if none.
# Show ó°–‚ if a vpn connection is active

# Change the name of the interfaces to match the ones given by ip a command
wifilink=wlan
vpnlink=wg

# Wifi
if [ "$(cat /sys/class/net/$wifilink*/operstate 2>/dev/null)" = 'up' ] ; then
	wifistrength="$(awk '/^\s*w/ { print int($3 * 100 / 70) }' /proc/net/wireless)"
elif [ "$(cat /sys/class/net/$wifilink/operstate 2>/dev/null)" = 'down' ] ; then
	[ "$(cat /sys/class/net/w*/flags 2>/dev/null)" = '0x1003' ] && wifiicon="ðŸ“¡" || wifiicon="âŒ"
fi

if [ -n "$wifistrength" ]; then
        case 1 in
                $((wifistrength >= 80)) ) wifiicon="ó°¤¨" ;;
                $((wifistrength >= 60)) ) wifiicon="ó°¤¥" ;;
                $((wifistrength >= 40)) ) wifiicon="ó°¤¢" ;;
                $((wifistrength >= 20)) ) wifiicon="ó°¤Ÿ" ;;
                * ) icon=ó°¤¯ ;;
        esac
fi

# Ethernet
if [ "$(cat /sys/class/net/e*/operstate 2>/dev/null)" = 'up' ]; then
         ethericon="ó°ˆ€"
         [ "$wifiicon" = "âŒ" ] && wifiicon="" || wifiicon=" $wifiicon"
fi

# VPN
[ -n "$(cat /sys/class/net/$vpnlink*/operstate 2>/dev/null)" ] && tunicon=" ó°–‚"

printf "%s%s%s" "$ethericon" "$wifiicon" "$tunicon"
